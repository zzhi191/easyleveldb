  function fromStream(methodName, method) {
    db[methodName] = function() {
      var stream = method.apply(this, arguments)
      var defer = Q.defer()
      var failed
      stream.on('data', function(data) {
        defer.notify(data)
      })

      stream.on('error', function(err) {
        failed = true
        defer.reject(err)
      })

      stream.on('close', function() {
        if (!failed) defer.resolve()
      })

      return defer.promise
    }
  }
