var level = require('level')
var promisify = require('../')
var db = promisify(level('my.db'), { valueEncoding: 'json' })
var contents = {}

db.put('a', 1, function(err) {
  db.batch([
    { type: 'put', key: 'b', value: 2 },
    { type: 'put', key: 'c', value: 3 }
  ], function(err) {
    return db.createReadStream()
      .on('data', function(data) {
        contents[data.key] = data.value
      })
      .on('error', function(err) {
        console.log('Error reading stream', err)
      })
      .on('close', function(err) {
        console.log('Contents:', contents)
        db.close(function(err) {
          console.log('Closed')
        })
      })
  })
})
